<!-- Generated by SpecStory -->

# Venue Order Detail Enhancement Discussion (2025-03-25 23:10:27)

_**User**_

propæ²¡é—®é¢˜ï¼Œè¿™ä¸ªæ˜¯venueæ‹¿åˆ°çš„æ•°æ®ï¼š0: {id: "HwGISqQDUv", venueId: 1, venueName: "é‡‘æ²™æ¸¯12", venueLocation: "é‡‘æ²™æ¸¯12-220", venueContent: "okok",â€¦}
createdAt: "2025-03-25T08:01:58.000+00:00"
createdAtStr: "2025-03-25 16:01"
endTime: "2025-03-26T03:30:00.000+00:00"
endTimeStr: "2025-03-26 11:30"
id: "HwGISqQDUv"
startTime: "2025-03-26T02:00:00.000+00:00"
startTimeStr: "2025-03-26 10:00"
status: "å·²ç¡®è®¤"
totalPrice: 75
updatedAt: "2025-03-25T08:01:58.000+00:00"
userId: "OsPcvnikSK"
venueContent: "okok"
venueCoverImage: "http://localhost:8081/images/venue/1742730710025.jpg"
venueDetail: null
venueId: 1
venueLocation: "é‡‘æ²™æ¸¯12-220"
venueName: "é‡‘æ²™æ¸¯12"
message: "æ“ä½œæˆåŠŸï¼"æˆ‘å¸Œæœ›venueè®¢å•æ˜¾ç¤ºçš„æ•°æ®è¯¦ç»†ä¸€ç‚¹ï¼›å¯¹äºä¸¤ä¸ªè®¢å•ï¼Œç‚¹å‡»ä»¥åå¯ä»¥å¼¹å‡ºè¯¦ç»†æ¡†

---

_**Assistant**_

# è®¢å•é¡µé¢ä¼˜åŒ–å»ºè®®

æ ¹æ®æ‚¨æä¾›çš„æ•°æ®å’Œéœ€æ±‚ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›åœºåœ°è®¢å•æ˜¾ç¤ºæ›´è¯¦ç»†æ•°æ®ä»¥åŠæ·»åŠ ç‚¹å‡»å¼¹å‡ºè¯¦ç»†æ¡†çš„å®ç°æ–¹æ¡ˆã€‚

## 1. åœºåœ°è®¢å•æ˜¾ç¤ºä¼˜åŒ–

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹åœºåœ°è®¢å•åˆ—è¡¨é¡¹ï¼Œæ˜¾ç¤ºæ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š

```vue:pages/order/order.vue
<view v-else v-for="(order, index) in venueOrders" :key="index" class="order-item" @tap="showVenueDetail(order)">
  <view class="order-header">
    <text class="order-id">è®¢å•å·ï¼š{{ order.id }}</text>
    <text class="order-status" :class="getStatusClass(order.status)">{{ getStatusText(order.status) }}</text>
  </view>
  
  <view class="order-content">
    <view class="venue-info">
      <text class="venue-name">{{ order.venueName }}</text>
      <text class="venue-date">{{ order.startTimeStr || '' }} - {{ order.endTimeStr || '' }}</text>
      <text class="venue-address">åœ°å€ï¼š{{ order.venueLocation || order.location }}</text>
      <text class="venue-create-time">é¢„è®¢æ—¶é—´ï¼š{{ order.createdAtStr || '' }}</text>
    </view>
    
    <view class="order-price-container">
      <text class="price-label">ä»·æ ¼</text>
      <text class="order-price">Â¥{{ order.totalPrice.toFixed(2) }}</text>
    </view>
  </view>
  
  <view class="order-footer">
    <button 
      class="order-btn cancel" 
      v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
      @tap.stop="cancelOrder(order.id)"
    >
      å–æ¶ˆé¢„çº¦
    </button>
    
    <button 
      class="order-btn pay" 
      v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
      @tap.stop="payOrder(order.id)"
    >
      ç«‹å³æ”¯ä»˜
    </button>
  </view>
</view>
```

## 2. æ·»åŠ åœºåœ°è®¢å•è¯¦æƒ…å¼¹çª—

åœ¨æ¨¡æ¿éƒ¨åˆ†æ·»åŠ åœºåœ°è®¢å•è¯¦æƒ…å¼¹çª—ï¼š

```vue:pages/order/order.vue
<!-- åœºåœ°è¯¦æƒ…å¼¹çª— -->
<view class="detail-modal" v-if="showVenueDetailModal">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">åœºåœ°é¢„çº¦è¯¦æƒ…</text>
      <text class="modal-close" @tap="showVenueDetailModal = false">Ã—</text>
    </view>
    <view class="modal-body">
      <view class="detail-item">
        <text class="detail-label">åœºé¦†åç§°</text>
        <text class="detail-value">{{ currentVenue.venueName }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">åœºé¦†åœ°å€</text>
        <text class="detail-value">{{ currentVenue.venueLocation || currentVenue.location }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">é¢„çº¦æ—¶é—´</text>
        <text class="detail-value">{{ currentVenue.startTimeStr || '' }} - {{ currentVenue.endTimeStr || '' }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">é¢„çº¦çŠ¶æ€</text>
        <text class="detail-value status" :class="getStatusClass(currentVenue.status)">{{ getStatusText(currentVenue.status) }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">è®¢å•é‡‘é¢</text>
        <text class="detail-value price">Â¥{{ currentVenue.totalPrice ? currentVenue.totalPrice.toFixed(2) : '0.00' }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">è®¢å•å·</text>
        <text class="detail-value">{{ currentVenue.id }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">åˆ›å»ºæ—¶é—´</text>
        <text class="detail-value">{{ currentVenue.createdAtStr || '' }}</text>
      </view>
      <view class="detail-item" v-if="currentVenue.venueContent">
        <text class="detail-label">åœºé¦†ä»‹ç»</text>
        <text class="detail-value">{{ currentVenue.venueContent }}</text>
      </view>
      <view class="detail-item" v-if="currentVenue.venueCoverImage">
        <text class="detail-label">åœºé¦†å›¾ç‰‡</text>
        <image :src="currentVenue.venueCoverImage" mode="aspectFill" class="venue-cover-image"></image>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn close" @tap="showVenueDetailModal = false">å…³é—­</button>
      <button 
        class="modal-btn pay" 
        v-if="currentVenue.status === 'PENDING' || currentVenue.status === 'å¾…æ”¯ä»˜'"
        @tap="payOrder(currentVenue.id)"
      >
        å»æ”¯ä»˜
      </button>
    </view>
  </view>
</view>
```

## 3. æ·»åŠ é“å…·è¯¦æƒ…å¼¹çª—

åŒæ ·ï¼Œä¸ºé“å…·ç§Ÿå€Ÿæ·»åŠ è¯¦æƒ…å¼¹çª—ï¼š

```vue:pages/order/order.vue
<!-- é“å…·è¯¦æƒ…å¼¹çª— -->
<view class="detail-modal" v-if="showPropDetailModal">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">é“å…·ç§Ÿå€Ÿè¯¦æƒ…</text>
      <text class="modal-close" @tap="showPropDetailModal = false">Ã—</text>
    </view>
    <view class="modal-body">
      <view class="detail-item" v-if="currentProp.propCoverImage">
        <image :src="currentProp.propCoverImage" mode="aspectFill" class="prop-cover-image"></image>
      </view>
      <view class="detail-item">
        <text class="detail-label">é“å…·åç§°</text>
        <text class="detail-value">{{ currentProp.propName }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">ç§Ÿå€ŸçŠ¶æ€</text>
        <text class="detail-value status" :class="getRentalStatusClass(currentProp.status)">{{ currentProp.status }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">å¼€å§‹æ—¶é—´</text>
        <text class="detail-value">{{ formatTime(currentProp.startDate) }}</text>
      </view>
      <view class="detail-item" v-if="currentProp.endDate">
        <text class="detail-label">å½’è¿˜æ—¶é—´</text>
        <text class="detail-value">{{ formatTime(currentProp.endDate) }}</text>
      </view>
      <view class="detail-item" v-if="currentProp.status === 'ç§Ÿå€Ÿä¸­'">
        <text class="detail-label">å·²ç§Ÿå€Ÿæ—¶é•¿</text>
        <text class="detail-value duration">{{ calculateDuration(currentProp.startDate) }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">ç§Ÿå€Ÿè´¹ç”¨</text>
        <text class="detail-value price" v-if="currentProp.totalPrice">Â¥{{ currentProp.totalPrice.toFixed(2) }}</text>
        <text class="detail-value price estimated" v-else>{{ estimatePrice(currentProp) }}</text>
      </view>
      <view class="detail-item">
        <text class="detail-label">è®¢å•å·</text>
        <text class="detail-value">{{ currentProp.id }}</text>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn close" @tap="showPropDetailModal = false">å…³é—­</button>
      <button 
        class="modal-btn return" 
        v-if="currentProp.status === 'ç§Ÿå€Ÿä¸­'"
        @tap="returnRental(currentProp.id)"
      >
        å½’è¿˜é“å…·
      </button>
    </view>
  </view>
</view>
```

## 4. æ·»åŠ ç›¸å…³çš„JavaScriptä»£ç 

åœ¨scriptéƒ¨åˆ†æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```javascript:pages/order/order.vue
// åœ¨ç°æœ‰çš„refå£°æ˜ä¸­æ·»åŠ 
const showVenueDetailModal = ref(false);
const showPropDetailModal = ref(false);
const currentVenue = ref({});
const currentProp = ref({});

// æ˜¾ç¤ºåœºåœ°è¯¦æƒ…
const showVenueDetail = (order) => {
  currentVenue.value = order;
  showVenueDetailModal.value = true;
};

// æ˜¾ç¤ºé“å…·è¯¦æƒ…
const showPropDetail = (rental) => {
  currentProp.value = rental;
  showPropDetailModal.value = true;
};

// åœ¨é“å…·ç§Ÿå€Ÿåˆ—è¡¨ä¸­æ·»åŠ ç‚¹å‡»äº‹ä»¶
// ä¿®æ”¹é“å…·ç§Ÿå€Ÿåˆ—è¡¨çš„v-foréƒ¨åˆ†ï¼Œæ·»åŠ @tap="showPropDetail(rental)"
```

## 5. æ·»åŠ ç›¸å…³çš„CSSæ ·å¼

åœ¨styleéƒ¨åˆ†æ·»åŠ ä»¥ä¸‹æ ·å¼ï¼š

```scss:pages/order/order.vue
/* æ–°å¢è®¢å•è¯¦æƒ…å¡ç‰‡æ ·å¼ */
.venue-create-time {
  font-size: 24rpx;
  color: #999;
  margin-top: 6rpx;
  display: block;
}

.order-price-container {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  justify-content: center;
}

.price-label {
  font-size: 24rpx;
  color: #999;
  margin-bottom: 4rpx;
}

/* è¯¦æƒ…å¼¹çª—æ ·å¼ */
.detail-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 100;
}

.modal-content {
  width: 90%;
  max-height: 80vh;
  background-color: #fff;
  border-radius: 16rpx;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.modal-header {
  padding: 30rpx;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1rpx solid #f0f0f0;
}

.modal-title {
  font-size: 34rpx;
  font-weight: 600;
  color: #333;
}

.modal-close {
  font-size: 40rpx;
  color: #999;
  line-height: 1;
}

.modal-body {
  padding: 30rpx;
  flex: 1;
  overflow-y: auto;
}

.detail-item {
  margin-bottom: 20rpx;
}

.detail-label {
  font-size: 28rpx;
  color: #999;
  margin-bottom: 8rpx;
  display: block;
}

.detail-value {
  font-size: 30rpx;
  color: #333;
}

.detail-value.status {
  display: inline-block;
  padding: 4rpx 16rpx;
  border-radius: 100rpx;
  font-size: 26rpx;
}

.detail-value.price {
  color: #ff5a5f;
  font-weight: 600;
}

.detail-value.duration {
  color: #3f8cff;
  font-weight: 500;
}

.venue-cover-image, .prop-cover-image {
  width: 100%;
  height: 300rpx;
  border-radius: 12rpx;
  margin-top: 10rpx;
}

.modal-footer {
  display: flex;
  border-top: 1rpx solid #f0f0f0;
}

.modal-btn {
  flex: 1;
  text-align: center;
  padding: 24rpx 0;
  font-size: 30rpx;
  background-color: #fff;
  border: none;
  border-radius: 0;
}

.modal-btn.close {
  background-color: #f5f5f5;
  color: #666;
}

.modal-btn.pay {
  background-color: #3f8cff;
  color: #fff;
}

.modal-btn.return {
  background-color: #3f8cff;
  color: #fff;
}
```

## 6. ä¿®æ”¹é“å…·ç§Ÿå€Ÿåˆ—è¡¨é¡¹

æœ€åï¼Œä¿®æ”¹é“å…·ç§Ÿå€Ÿåˆ—è¡¨é¡¹ï¼Œæ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼š

```vue:pages/order/order.vue
<view v-else v-for="(rental, index) in propRentals" :key="index" class="rental-item" @tap="showPropDetail(rental)">
  <!-- ä¿æŒç°æœ‰å†…å®¹ä¸å˜ï¼Œåªæ·»åŠ @tapäº‹ä»¶ -->
</view>
```

è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥å®ç°åœºåœ°è®¢å•æ˜¾ç¤ºæ›´è¯¦ç»†çš„æ•°æ®ï¼Œå¹¶ä¸”ç‚¹å‡»è®¢å•åå¼¹å‡ºè¯¦ç»†ä¿¡æ¯æ¡†çš„åŠŸèƒ½ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»è®¢å•é¡¹æŸ¥çœ‹æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

---

_**User**_

åœºé¦†å›¾ç‰‡ä¹Ÿåœ¨åˆ—è¡¨æ˜¾ç¤ºä¸€ä¸‹

---

_**Assistant**_

# åœ¨åœºé¦†è®¢å•åˆ—è¡¨ä¸­æ·»åŠ å›¾ç‰‡æ˜¾ç¤º

å¥½çš„ï¼Œæˆ‘å°†åœ¨åœºåœ°é¢„çº¦åˆ—è¡¨ä¸­æ·»åŠ åœºé¦†å›¾ç‰‡æ˜¾ç¤ºã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ä»£ç ï¼š

```vue:pages/order/order.vue
<view v-else v-for="(order, index) in venueOrders" :key="index" class="order-item" @tap="showVenueDetail(order)">
  <view class="order-header">
    <text class="order-id">è®¢å•å·ï¼š{{ order.id }}</text>
    <text class="order-status" :class="getStatusClass(order.status)">{{ getStatusText(order.status) }}</text>
  </view>
  
  <view class="order-content">
    <view class="venue-image-container" v-if="order.venueCoverImage">
      <image :src="order.venueCoverImage" mode="aspectFill" class="venue-list-image"></image>
    </view>
    
    <view class="venue-info">
      <text class="venue-name">{{ order.venueName }}</text>
      <text class="venue-date">{{ order.startTimeStr || '' }} - {{ order.endTimeStr || '' }}</text>
      <text class="venue-address">åœ°å€ï¼š{{ order.venueLocation || order.location }}</text>
      <text class="venue-create-time">é¢„è®¢æ—¶é—´ï¼š{{ order.createdAtStr || '' }}</text>
    </view>
    
    <view class="order-price-container">
      <text class="price-label">ä»·æ ¼</text>
      <text class="order-price">Â¥{{ order.totalPrice.toFixed(2) }}</text>
    </view>
  </view>
  
  <view class="order-footer">
    <button 
      class="order-btn cancel" 
      v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
      @tap.stop="cancelOrder(order.id)"
    >
      å–æ¶ˆé¢„çº¦
    </button>
    
    <button 
      class="order-btn pay" 
      v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
      @tap.stop="payOrder(order.id)"
    >
      ç«‹å³æ”¯ä»˜
    </button>
  </view>
</view>
```

åŒæ—¶ï¼Œéœ€è¦åœ¨æ ·å¼éƒ¨åˆ†æ·»åŠ ä»¥ä¸‹CSSï¼š

```css:pages/order/order.vue
/* åœºé¦†å›¾ç‰‡æ ·å¼ */
.order-content {
  display: flex;
  flex-wrap: wrap;
  padding: 20rpx;
  background-color: #fff;
  border-bottom: 1rpx solid #f0f0f0;
}

.venue-image-container {
  width: 160rpx;
  height: 120rpx;
  margin-right: 20rpx;
  border-radius: 8rpx;
  overflow: hidden;
}

.venue-list-image {
  width: 100%;
  height: 100%;
}

.venue-info {
  flex: 1;
  min-width: 0;
}

.order-price-container {
  margin-left: auto;
  text-align: right;
}
```

è¿™æ ·ä¿®æ”¹åï¼Œåœºåœ°é¢„çº¦åˆ—è¡¨ä¸­å°†æ˜¾ç¤ºåœºé¦†çš„å°é¢å›¾ç‰‡ï¼Œä½¿ç•Œé¢æ›´åŠ ç›´è§‚å’Œç¾è§‚ã€‚å›¾ç‰‡ä¼šæ˜¾ç¤ºåœ¨åœºé¦†ä¿¡æ¯çš„å·¦ä¾§ï¼Œå¤§å°é€‚ä¸­ï¼Œä¸ä¼šå½±å“æ•´ä½“å¸ƒå±€ã€‚

---

_**User**_

venueçš„å±•ç¤ºæ ·å¼ç¾åŒ–ä¸€ä¸‹å‘€ï¼›å°é¢å›¾ç‰‡æ˜¾ç¤ºå ä¸€è¡Œä¸‹é¢æ”¾æ ‡é¢˜ï¼Œä»·æ ¼ï¼Œè®¢å•æ—¶é—´ï¼Œä½¿ç”¨æ—¶é—´ï¼Œå…¶ä»–çš„ä¿¡æ¯è¯¦ç»†é¡µé¢æ˜¾ç¤º

---

_**Assistant**_



# ç¾åŒ–åœºåœ°é¢„çº¦åˆ—è¡¨æ ·å¼

å¥½çš„ï¼Œæˆ‘å°†é‡æ–°è®¾è®¡åœºåœ°é¢„çº¦åˆ—è¡¨çš„æ ·å¼ï¼Œè®©å°é¢å›¾ç‰‡å ä¸€è¡Œï¼Œä¸‹é¢æ”¾ç½®æ ‡é¢˜ã€ä»·æ ¼ã€è®¢å•æ—¶é—´å’Œä½¿ç”¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ä»£ç ï¼š

```vue:pages/order/order.vue
<!-- åœºåœ°é¢„çº¦åˆ—è¡¨ -->
<view v-if="activeTab === 'venue'" class="order-list">
  <view v-if="venueOrders.length === 0" class="empty-state">
    <image src="/static/images/empty.png" mode="aspectFit" class="empty-image"></image>
    <text class="empty-text">æš‚æ— åœºåœ°é¢„çº¦è®°å½•</text>
  </view>
  
  <view v-else v-for="(order, index) in venueOrders" :key="index" class="order-item" @tap="showVenueDetail(order)">
    <view class="order-header">
      <text class="order-id">è®¢å•å·ï¼š{{ order.id }}</text>
      <text class="order-status" :class="getStatusClass(order.status)">{{ getStatusText(order.status) }}</text>
    </view>
    
    <view class="venue-image-wrapper" v-if="order.venueCoverImage">
      <image :src="order.venueCoverImage" mode="aspectFill" class="venue-cover"></image>
    </view>
    
    <view class="order-content">
      <view class="venue-title-row">
        <text class="venue-name">{{ order.venueName }}</text>
        <text class="order-price">Â¥{{ order.totalPrice.toFixed(2) }}</text>
      </view>
      
      <view class="venue-info-row">
        <text class="info-label">é¢„è®¢æ—¶é—´ï¼š</text>
        <text class="info-value">{{ order.createdAtStr || '' }}</text>
      </view>
      
      <view class="venue-info-row">
        <text class="info-label">ä½¿ç”¨æ—¶é—´ï¼š</text>
        <text class="info-value">{{ order.startTimeStr || '' }} - {{ order.endTimeStr || '' }}</text>
      </view>
    </view>
    
    <view class="order-footer">
      <button 
        class="order-btn cancel" 
        v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
        @tap.stop="cancelOrder(order.id)"
      >
        å–æ¶ˆé¢„çº¦
      </button>
      
      <button 
        class="order-btn pay" 
        v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
        @tap.stop="payOrder(order.id)"
      >
        ç«‹å³æ”¯ä»˜
      </button>
    </view>
  </view>
</view>
```

æ·»åŠ ç›¸åº”çš„CSSæ ·å¼ï¼š

```css:pages/order/order.vue
/* ç¾åŒ–åœºåœ°é¢„çº¦åˆ—è¡¨æ ·å¼ */
.order-item {
  background-color: #ffffff;
  border-radius: 16rpx;
  margin-bottom: 20rpx;
  overflow: hidden;
  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);
}

.order-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20rpx;
  border-bottom: 1rpx solid #f0f0f0;
}

.order-id {
  font-size: 26rpx;
  color: #666;
}

.order-status {
  font-size: 26rpx;
  font-weight: 500;
  padding: 4rpx 16rpx;
  border-radius: 100rpx;
}

.venue-image-wrapper {
  width: 100%;
  height: 300rpx;
  overflow: hidden;
}

.venue-cover {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.order-content {
  padding: 20rpx;
  background-color: #fff;
}

.venue-title-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16rpx;
}

.venue-name {
  font-size: 32rpx;
  font-weight: 600;
  color: #333;
  flex: 1;
}

.order-price {
  font-size: 32rpx;
  font-weight: 600;
  color: #ff5a5f;
}

.venue-info-row {
  display: flex;
  margin-bottom: 8rpx;
}

.info-label {
  font-size: 26rpx;
  color: #999;
  width: 150rpx;
}

.info-value {
  font-size: 26rpx;
  color: #333;
  flex: 1;
}

.order-footer {
  display: flex;
  justify-content: flex-end;
  padding: 20rpx;
  border-top: 1rpx solid #f0f0f0;
}

.order-btn {
  font-size: 28rpx;
  padding: 10rpx 30rpx;
  margin-left: 20rpx;
  border-radius: 100rpx;
  border: none;
}

.order-btn.cancel {
  background-color: #f5f5f5;
  color: #666;
}

.order-btn.pay {
  background-color: #3f8cff;
  color: #fff;
}
```

è¿™æ ·ä¿®æ”¹åï¼Œåœºåœ°é¢„çº¦åˆ—è¡¨çš„æ ·å¼å°†æ›´åŠ ç¾è§‚ï¼š
- å°é¢å›¾ç‰‡å æ®æ•´è¡Œæ˜¾ç¤º
- ä¸‹æ–¹æ˜¾ç¤ºåœºé¦†åç§°å’Œä»·æ ¼
- æ¥ç€æ˜¾ç¤ºé¢„è®¢æ—¶é—´å’Œä½¿ç”¨æ—¶é—´
- å…¶ä»–è¯¦ç»†ä¿¡æ¯åœ¨ç‚¹å‡»åçš„è¯¦æƒ…é¡µé¢ä¸­å±•ç¤º

è¿™ç§è®¾è®¡æ›´åŠ ç¬¦åˆç°ä»£ç§»åŠ¨åº”ç”¨çš„UIé£æ ¼ï¼Œä¹Ÿèƒ½è®©ç”¨æˆ·æ›´ç›´è§‚åœ°çœ‹åˆ°åœºåœ°çš„å¤–è§‚ã€‚

---

_**User**_

æ’ç‰ˆåšå¥½ä¸€ç‚¹å‘€

---

_**Assistant**_



# ä¼˜åŒ–åœºåœ°è®¢å•åˆ—è¡¨æ’ç‰ˆ

æˆ‘å°†ä¸ºæ‚¨ä¼˜åŒ–åœºåœ°è®¢å•åˆ—è¡¨çš„æ’ç‰ˆï¼Œä½¿å…¶æ›´åŠ ç¾è§‚å’Œä¸“ä¸šã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ä»£ç ï¼š

```vue:pages/order/order.vue
<!-- åœºåœ°é¢„çº¦åˆ—è¡¨ -->
<view v-if="activeTab === 'venue'" class="order-list">
  <view v-if="venueOrders.length === 0" class="empty-state">
    <image src="/static/images/empty.png" mode="aspectFit" class="empty-image"></image>
    <text class="empty-text">æš‚æ— åœºåœ°é¢„çº¦è®°å½•</text>
  </view>
  
  <view v-else v-for="(order, index) in venueOrders" :key="index" class="order-item" @tap="showVenueDetail(order)">
    <view class="order-status-bar" :class="getStatusClass(order.status)">
      <text>{{ getStatusText(order.status) }}</text>
    </view>
    
    <view class="venue-image-wrapper" v-if="order.venueCoverImage">
      <image :src="order.venueCoverImage" mode="aspectFill" class="venue-cover"></image>
    </view>
    
    <view class="order-main-content">
      <view class="venue-title-row">
        <text class="venue-name">{{ order.venueName }}</text>
        <text class="order-price">Â¥{{ order.totalPrice.toFixed(2) }}</text>
      </view>
      
      <view class="venue-time-info">
        <view class="time-item">
          <text class="time-icon">ğŸ•’</text>
          <text class="time-text">{{ order.startTimeStr || '' }} - {{ order.endTimeStr || '' }}</text>
        </view>
        
        <view class="time-item">
          <text class="time-icon">ğŸ“…</text>
          <text class="time-text">{{ order.createdAtStr || '' }}</text>
        </view>
      </view>
      
      <view class="order-id-row">
        <text class="order-id">è®¢å•å·ï¼š{{ order.id }}</text>
      </view>
    </view>
    
    <view class="order-footer">
      <button 
        class="order-btn cancel" 
        v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
        @tap.stop="cancelOrder(order.id)"
      >
        å–æ¶ˆé¢„çº¦
      </button>
      
      <button 
        class="order-btn pay" 
        v-if="order.status === 'PENDING' || order.status === 'å¾…æ”¯ä»˜'"
        @tap.stop="payOrder(order.id)"
      >
        ç«‹å³æ”¯ä»˜
      </button>
    </view>
  </view>
</view>
```

æ·»åŠ ç›¸åº”çš„CSSæ ·å¼ï¼š

```css:pages/order/order.vue
/* ç¾åŒ–åœºåœ°é¢„çº¦åˆ—è¡¨æ ·å¼ */
.order-list {
  padding: 20rpx;
}

.order-item {
  background-color: #ffffff;
  border-radius: 16rpx;
  margin-bottom: 30rpx;
  overflow: hidden;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.08);
  position: relative;
}

.order-status-bar {
  position: absolute;
  top: 0;
  right: 0;
  padding: 8rpx 24rpx;
  color: #fff;
  font-size: 24rpx;
  border-bottom-left-radius: 16rpx;
  z-index: 2;
}

.venue-image-wrapper {
  width: 100%;
  height: 320rpx;
  overflow: hidden;
  position: relative;
}

.venue-cover {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}

.order-item:active .venue-cover {
  transform: scale(1.05);
}

.order-main-content {
  padding: 24rpx;
}

.venue-title-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20rpx;
}

.venue-name {
  font-size: 34rpx;
  font-weight: 600;
  color: #333;
  flex: 1;
}

.order-price {
  font-size: 34rpx;
  font-weight: 600;
  color: #ff5a5f;
}

.venue-time-info {
  margin-bottom: 16rpx;
}

.time-item {
  display: flex;
  align-items: center;
  margin-bottom: 10rpx;
}

.time-icon {
  margin-right: 10rpx;
  font-size: 28rpx;
}

.time-text {
  font-size: 28rpx;
  color: #666;
}

.order-id-row {
  margin-top: 16rpx;
  padding-top: 16rpx;
  border-top: 1rpx solid #f0f0f0;
}

.order-id {
  font-size: 26rpx;
  color: #999;
}

.order-footer {
  display: flex;
  justify-content: flex-end;
  padding: 20rpx 24rpx;
  border-top: 1rpx solid #f0f0f0;
  background-color: #fafafa;
}

.order-btn {
  font-size: 28rpx;
  padding: 12rpx 36rpx;
  margin-left: 20rpx;
  border-radius: 100rpx;
  border: none;
}

.order-btn.cancel {
  background-color: #f5f5f5;
  color: #666;
}

.order-btn.pay {
  background-color: #3f8cff;
  color: #fff;
}

/* çŠ¶æ€é¢œè‰² */
.status-pending, .status-å¾…æ”¯ä»˜ {
  background-color: #ff9500;
}

.status-confirmed, .status-å·²ç¡®è®¤ {
  background-color: #34c759;
}

.status-completed, .status-å·²å®Œæˆ {
  background-color: #5ac8fa;
}

.status-cancelled, .status-å·²å–æ¶ˆ {
  background-color: #8e8e93;
}
```

è¿™æ ·ä¿®æ”¹åï¼Œåœºåœ°é¢„çº¦åˆ—è¡¨å°†å…·æœ‰æ›´åŠ ç°ä»£åŒ–å’Œä¸“ä¸šçš„å¤–è§‚ï¼š
- çŠ¶æ€æ ‡ç­¾æ˜¾ç¤ºåœ¨å³ä¸Šè§’ï¼Œé¢œè‰²åŒºåˆ†ä¸åŒçŠ¶æ€
- å°é¢å›¾ç‰‡æ›´å¤§ï¼Œæœ‰è½»å¾®çš„æ‚¬åœæ•ˆæœ
- åœºé¦†åç§°å’Œä»·æ ¼æ›´åŠ çªå‡º
- æ—¶é—´ä¿¡æ¯ä½¿ç”¨å›¾æ ‡å¢å¼ºå¯è¯»æ€§
- è®¢å•å·æ”¾åœ¨åº•éƒ¨ï¼Œä¸é‚£ä¹ˆæ˜¾çœ¼ä½†ä»ç„¶å¯è§
- æŒ‰é’®æ ·å¼æ›´åŠ åœ†æ¶¦ï¼Œç¬¦åˆç°ä»£è®¾è®¡è¶‹åŠ¿

è¿™ç§è®¾è®¡æ›´åŠ ç¬¦åˆå½“å‰æµè¡Œçš„ç§»åŠ¨åº”ç”¨UIé£æ ¼ï¼Œæä¾›æ›´å¥½çš„è§†è§‰å±‚æ¬¡å’Œç”¨æˆ·ä½“éªŒã€‚

---

_**User**_

ä¸è¦ç”¨ä¸­æ–‡å‘€

---

_**Assistant**_



# ä¿®æ”¹çŠ¶æ€æ ·å¼ç±»å

æˆ‘å°†æŠŠçŠ¶æ€æ ·å¼ç±»åä»ä¸­æ–‡æ”¹ä¸ºè‹±æ–‡ï¼Œä»¥é¿å…æ½œåœ¨çš„ç¼–ç é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ä»£ç ï¼š

```css:pages/order/order.vue
/* çŠ¶æ€é¢œè‰² */
.status-pending, .status-waiting-payment {
	background-color: #ff9500;
}

.status-confirmed {
	background-color: #34c759;
}

.status-completed {
	background-color: #5ac8fa;
}

.status-cancelled {
	background-color: #8e8e93;
}
```

åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ç›¸å…³çš„çŠ¶æ€å¤„ç†å‡½æ•°ï¼Œç¡®ä¿å®ƒèƒ½æ­£ç¡®åœ°å°†ä¸­æ–‡çŠ¶æ€æ˜ å°„åˆ°è‹±æ–‡ç±»åï¼š

```javascript:pages/order/order.vue
// è·å–çŠ¶æ€å¯¹åº”çš„æ ·å¼ç±»
const getStatusClass = (status) => {
	if (!status) return '';
	
	switch (status) {
		case 'PENDING':
		case 'å¾…æ”¯ä»˜':
			return 'status-waiting-payment';
		case 'CONFIRMED':
		case 'å·²ç¡®è®¤':
			return 'status-confirmed';
		case 'COMPLETED':
		case 'å·²å®Œæˆ':
			return 'status-completed';
		case 'CANCELLED':
		case 'å·²å–æ¶ˆ':
			return 'status-cancelled';
		default:
			return '';
	}
};
```

è¿™æ ·ä¿®æ”¹åï¼Œæˆ‘ä»¬ä½¿ç”¨äº†çº¯è‹±æ–‡çš„CSSç±»åï¼ŒåŒæ—¶ä¿æŒäº†å¯¹ä¸­æ–‡çŠ¶æ€å€¼çš„å…¼å®¹æ€§ã€‚

---

_**User**_

é“å…·è¿™ä¸ªé¡µé¢ï¼ŒæŸ¥è¯¢ä»listä¼šè¿”å›æ‰€æœ‰çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›ç”¨æˆ·ç‚¹å‡»å¯ç§Ÿå€Ÿ/ä¸å¯ç§Ÿå€Ÿçš„æ—¶å€™ç›´æ¥åœ¨æœ¬åœ°åˆ¤æ–­ï¼Œç„¶åæ˜¾ç¤ºid: 4, name: "555", description: "2222", price: 1, available: true

---

_**Assistant**_

<think>
The user wants to modify the props rental system to filter items locally based on availability without making additional server requests. Let me understand what needs to be done:

1. When displaying the list of props, they want to show all props regardless of availability
2. Users should be able to filter between "available" and "unavailable" props locally
3. Each prop has properties like id, name, description, price, and an "available" boolean flag

I need to add UI elements to toggle between available and unavailable props, and implement local filtering logic. Here's my plan:

1. Add filter buttons/tabs at the top of the props section
2. Add state to track the current filter selection
3. Implement a computed property or filter function to filter the props list
4. Update the UI to show the filtered list

Let me write the code for this implementation.
</think>

# é“å…·åˆ—è¡¨æœ¬åœ°è¿‡æ»¤å®ç°

æˆ‘å°†å®ç°é“å…·åˆ—è¡¨çš„æœ¬åœ°è¿‡æ»¤åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥æ ¹æ®é“å…·çš„å¯ç”¨çŠ¶æ€è¿›è¡Œç­›é€‰ã€‚ä»¥ä¸‹æ˜¯å…·ä½“å®ç°ä»£ç ï¼š

```vue:pages/prop/prop-list.vue
<template>
  <view class="prop-container">
    <!-- ç­›é€‰é€‰é¡¹ -->
    <view class="filter-tabs">
      <view 
        class="filter-tab" 
        :class="{ active: activeFilter === 'all' }"
        @tap="setFilter('all')"
      >
        å…¨éƒ¨é“å…·
      </view>
      <view 
        class="filter-tab" 
        :class="{ active: activeFilter === 'available' }"
        @tap="setFilter('available')"
      >
        å¯ç§Ÿå€Ÿ
      </view>
      <view 
        class="filter-tab" 
        :class="{ active: activeFilter === 'unavailable' }"
        @tap="setFilter('unavailable')"
      >
        ä¸å¯ç§Ÿå€Ÿ
      </view>
    </view>
    
    <!-- é“å…·åˆ—è¡¨ -->
    <view class="prop-list">
      <view v-if="filteredProps.length === 0" class="empty-state">
        <image src="/static/images/empty.png" mode="aspectFit" class="empty-image"></image>
        <text class="empty-text">æš‚æ— é“å…·</text>
      </view>
      
      <view v-else v-for="(prop, index) in filteredProps" :key="prop.id" class="prop-item" @tap="showPropDetail(prop)">
        <view class="prop-image-container" v-if="prop.coverImage">
          <image :src="prop.coverImage" mode="aspectFill" class="prop-image"></image>
          <view class="availability-tag" :class="prop.available ? 'available' : 'unavailable'">
            {{ prop.available ? 'å¯ç§Ÿå€Ÿ' : 'ä¸å¯ç§Ÿå€Ÿ' }}
          </view>
        </view>
        
        <view class="prop-info">
          <text class="prop-name">{{ prop.name }}</text>
          <text class="prop-desc">{{ prop.description }}</text>
          <view class="prop-price-row">
            <text class="prop-price">Â¥{{ prop.price }}/å°æ—¶</text>
            <button 
              class="rent-btn" 
              :class="prop.available ? 'active' : 'disabled'" 
              @tap.stop="rentProp(prop)"
              :disabled="!prop.available"
            >
              {{ prop.available ? 'ç«‹å³ç§Ÿå€Ÿ' : 'ä¸å¯ç§Ÿå€Ÿ' }}
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue';
import { getAllProps } from '../../api/prop.js';

// çŠ¶æ€
const propList = ref([]);
const loading = ref(false);
const activeFilter = ref('all'); // é»˜è®¤æ˜¾ç¤ºå…¨éƒ¨

// è·å–æ‰€æœ‰é“å…·
const fetchAllProps = async () => {
  try {
    loading.value = true;
    const result = await getAllProps();
    
    if (result.code === 1 && result.data) {
      propList.value = result.data;
    } else {
      uni.showToast({
        title: result.msg || 'è·å–é“å…·å¤±è´¥',
        icon: 'none'
      });
    }
  } catch (error) {
    console.error('è·å–é“å…·å¤±è´¥:', error);
    uni.showToast({
      title: 'è·å–é“å…·å¤±è´¥',
      icon: 'none'
    });
  } finally {
    loading.value = false;
  }
};

// åˆ‡æ¢ç­›é€‰é€‰é¡¹
const setFilter = (filter) => {
  activeFilter.value = filter;
};

// æ ¹æ®ç­›é€‰æ¡ä»¶è¿‡æ»¤é“å…·
const filteredProps = computed(() => {
  if (activeFilter.value === 'all') {
    return propList.value;
  } else if (activeFilter.value === 'available') {
    return propList.value.filter(prop => prop.available);
  } else {
    return propList.value.filter(prop => !prop.available);
  }
});

// æ˜¾ç¤ºé“å…·è¯¦æƒ…
const showPropDetail = (prop) => {
  uni.navigateTo({
    url: `/pages/prop/prop-detail?id=${prop.id}`
  });
};

// ç§Ÿå€Ÿé“å…·
const rentProp = (prop) => {
  if (!prop.available) {
    uni.showToast({
      title: 'è¯¥é“å…·ä¸å¯ç§Ÿå€Ÿ',
      icon: 'none'
    });
    return;
  }
  
  uni.navigateTo({
    url: `/pages/prop/prop-rent?id=${prop.id}`
  });
};

// é¡µé¢åŠ è½½æ—¶è·å–é“å…·åˆ—è¡¨
onMounted(() => {
  fetchAllProps();
});
</script>

<style lang="scss">
.prop-container {
  padding: 20rpx;
  background-color: #f5f5f5;
  min-height: 100vh;
}

.filter-tabs {
  display: flex;
  background-color: #fff;
  border-radius: 12rpx;
  margin-bottom: 20rpx;
  overflow: hidden;
  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);
}

.filter-tab {
  flex: 1;
  text-align: center;
  padding: 20rpx 0;
  font-size: 28rpx;
  color: #666;
  position: relative;
}

.filter-tab.active {
  color: #3f8cff;
  font-weight: 500;
}

.filter-tab.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 25%;
  width: 50%;
  height: 4

---

_**User**_

æ˜¯è¿™ä¸ªæ–‡ä»¶é‡Œé¢ä¿®æ”¹

---

_**Assistant**_

<think>
I see, the user wants to modify the existing file (pages/prop/prop.vue) rather than creating a new file. Let me adjust my approach to modify the existing prop.vue file to implement local filtering based on the available property.

Looking at the original file, I can see it has a search box, filter box, and already has some filtering functionality. I need to modify it to filter locally after loading all props, rather than making separate API calls for each filter.

I'll keep the existing structure and components, but modify the logic to filter locally.
</think>

# ä¿®æ”¹é“å…·åˆ—è¡¨ä¸ºæœ¬åœ°è¿‡æ»¤

å¥½çš„ï¼Œæˆ‘å°†ä¿®æ”¹ç°æœ‰çš„ `pages/prop/prop.vue` æ–‡ä»¶ï¼Œå®ç°æœ¬åœ°è¿‡æ»¤åŠŸèƒ½ï¼š

```vue:pages/prop/prop.vue
<template>
	<view class="prop-container">
		<view class="header">
			<view class="search-box">
				<text class="search-icon">ğŸ”</text>
				<input type="text" v-model="searchText" placeholder="æœç´¢å¿ƒç†é“å…·" class="search-input" @input="handleLocalSearch" />
			</view>
			<view class="filter-box">
				<view class="filter-item" 
					  v-for="(filter, index) in filters" 
					  :key="index"
					  :class="{ active: activeFilter === index }"
					  @tap="setFilter(index)">
					{{ filter }}
				</view>
			</view>
		</view>
		
		<scroll-view class="prop-list" scroll-y="true" @scrolltolower="loadMore">
			<prop-item 
				v-for="(item, index) in filteredProps" 
				:key="index" 
				:prop-data="item"
				@item-click="onPropClick"
			></prop-item>
			
			<view v-if="loading" class="loading">åŠ è½½ä¸­...</view>
			<view v-if="noMoreData" class="no-more">æ²¡æœ‰æ›´å¤šé“å…·äº†</view>
		</scroll-view>
		
		<!-- æ‚¬æµ®æŒ‰é’® -->
		<view class="float-button" hover-class="float-button-hover" @tap="navigateToMyRentals">
			<view class="float-button-inner">
				<text class="float-icon">ğŸ“¦</text>
				<text class="float-text">æˆ‘çš„ç§Ÿå€Ÿ</text>
			</view>
		</view>
	</view>
</template>

<script setup>
import { ref, computed, onMounted, watch } from 'vue';
import PropItem from '../../components/prop-item/prop-item.vue';
import { getPropList, searchProp } from '../../api/prop.js';

// ä¿ç•™åŸºæœ¬ ref å˜é‡
const searchText = ref('');
const filters = ref(['å…¨éƒ¨', 'å¯ç§Ÿå€Ÿ', 'ä¸å¯ç§Ÿå€Ÿ']);
const activeFilter = ref(0);
const loading = ref(false);
const noMoreData = ref(false);
const propList = ref([]);
const showOnlyAvailable = ref(false);
const allProps = ref([]); // å­˜å‚¨æ‰€æœ‰é“å…·ï¼Œç”¨äºæœ¬åœ°è¿‡æ»¤

// æœ¬åœ°è¿‡æ»¤çš„è®¡ç®—å±æ€§
const filteredProps = computed(() => {
	// å…ˆæ ¹æ®æœç´¢æ–‡æœ¬è¿‡æ»¤
	let filtered = allProps.value;
	
	if (searchText.value.trim() !== '') {
		filtered = filtered.filter(prop => 
			prop.name?.toLowerCase().includes(searchText.value.toLowerCase()) || 
			prop.description?.toLowerCase().includes(searchText.value.toLowerCase())
		);
	}
	
	// ç„¶åæ ¹æ®å¯ç§Ÿå€ŸçŠ¶æ€è¿‡æ»¤
	if (activeFilter.value === 1) {
		// åªæ˜¾ç¤ºå¯ç§Ÿå€Ÿçš„é“å…·
		filtered = filtered.filter(prop => prop.available === true);
	} else if (activeFilter.value === 2) {
		// åªæ˜¾ç¤ºä¸å¯ç§Ÿå€Ÿçš„é“å…·
		filtered = filtered.filter(prop => prop.available === false);
	}
	
	return filtered;
});

// åŠ è½½æ‰€æœ‰é“å…·åˆ—è¡¨
const fetchAllProps = async () => {
	if (loading.value) return;
	
	loading.value = true;
	
	try {
		// è·å–æ‰€æœ‰é“å…·
		const result = await getPropList();
		
		console.log('APIè¿”å›é“å…·æ•°æ®:', result);
		
		// æ£€æŸ¥è¿”å›çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆ
		if (result.code === 1 && result.data && result.data.length > 0) {
			// ä¿å­˜æ‰€æœ‰é“å…·æ•°æ®ç”¨äºæœ¬åœ°è¿‡æ»¤
			allProps.value = result.data;
			console.log('é“å…·åˆ—è¡¨:', allProps.value);
		} else {
			// æ²¡æœ‰æ•°æ®æ—¶æ˜¾ç¤ºç©ºåˆ—è¡¨
			allProps.value = [];
		}
	} catch (error) {
		console.error('è·å–é“å…·åˆ—è¡¨å¤±è´¥:', error);
		uni.showToast({
			title: 'è·å–é“å…·åˆ—è¡¨å¤±è´¥',
			icon: 'none'
		});
	} finally {
		loading.value = false;
	}
};

// æœ¬åœ°æœç´¢å¤„ç†
const handleLocalSearch = () => {
	// æœç´¢é€»è¾‘å·²ç»åœ¨ filteredProps è®¡ç®—å±æ€§ä¸­å®ç°
	// è¿™é‡Œå¯ä»¥æ·»åŠ é¢å¤–çš„å¤„ç†é€»è¾‘ï¼Œå¦‚æœç´¢å»¶è¿Ÿç­‰
};

// è®¾ç½®ç­›é€‰æ¡ä»¶ - æœ¬åœ°è¿‡æ»¤
function setFilter(index) {
	if (activeFilter.value === index) return;
	
	activeFilter.value = index;
	// ä¸éœ€è¦é‡æ–°åŠ è½½æ•°æ®ï¼Œè®¡ç®—å±æ€§ä¼šè‡ªåŠ¨è¿‡æ»¤
}

// ç‚¹å‡»é“å…·
function onPropClick(id) {
	console.log('ç‚¹å‡»é“å…·:', id);
	uni.navigateTo({
		url: `/pages/prop_detail/prop_detail?id=${id}`
	});
}

// æ¸…é™¤æœç´¢å†…å®¹
function clearSearch() {
	searchText.value = '';
	// ä¸éœ€è¦é‡æ–°åŠ è½½æ•°æ®ï¼Œè®¡ç®—å±æ€§ä¼šè‡ªåŠ¨æ›´æ–°
}

// å¯¼èˆªåˆ°æˆ‘çš„ç§Ÿå€Ÿ
function navigateToMyRentals() {
	uni.navigateTo({
		url: '/pages/order/order?activeTab=prop'
	});
}

// åŠ è½½æ›´å¤šæ•°æ®
const loadMore = () => {
	// æœ¬åœ°è¿‡æ»¤ä¸éœ€è¦åˆ†é¡µåŠ è½½
	// è¿™é‡Œå¯ä»¥ä¿ç•™æ­¤æ–¹æ³•ä»¥ä¾¿æœªæ¥æ‰©å±•
};

// åˆå§‹åŠ è½½æ•°æ®
onMounted(() => {
	fetchAllProps();
});

</script>

<style lang="scss" scoped>
.prop-container {
	display: flex;
	flex-direction: column;
	height: 100vh;
	background-color: #f8f9fa;
	position: relative;
}

.header {
	padding: 30rpx 20rpx;
	background-color: #fff;
	box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);
	position: sticky;
	top: 0;
	z-index: 10;
	
	.search-box {
		display: flex;
		align-items: center;
		background-color: #f5f5f5;
		border-radius: 40rpx;
		padding: 15rpx 20rpx;
		margin-bottom: 20rpx;
		
		.search-icon {
			margin-right: 10rpx;
			font-size: 32rpx;
			color: #999;
		}
		
		.search-input {
			flex: 1;
			height: 60rpx;
			font-size: 28rpx;
		}
	}
	
	.filter-box {
		display: flex;
		justify-content: space-between;
		
		.filter-item {
			flex: 1;
			text-align: center;
			font-size: 26rpx;
			color: #666;
			padding: 10rpx 0;
			position: relative;
			
			&.active {
				color: #1a73e8;
				font-weight: 500;
				
				&::after {
					content: '';
					position: absolute;
					bottom: 0;
					left: 50%;
					transform: translateX(-50%);
					width: 40rpx;
					height: 4rpx;
					background-color: #1a73e8;
					border-radius: 2rpx;
				}
			}
		}
	}
}

.prop-list {
	flex: 1;
	padding: 20rpx;
	padding-bottom: 120rpx; /* ä¸ºæ‚¬æµ®æŒ‰é’®ç•™å‡ºç©ºé—´ */
}

.loading, .no-more {
	text-align: center;
	padding: 20rpx;
	font-size: 26rpx;
	color: #999;
}

/* æ‚¬æµ®æŒ‰é’®æ ·å¼ */
.float-button {
	position: fixed;
	right: 30rpx;
	bottom: 60rpx;
	width: 200rpx;
	height: 80rpx;
	background: linear-gradient(135deg, #1a73e8, #6c5ce7);
	border-radius: 40rpx;
	box-shadow: 0 6rpx 20rpx rgba(26, 115, 232, 0.3);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 100;
	transition: all 0.3s ease;
	
	.float-button-inner {
		display: flex;
		align-items: center;
		justify-content: center;
	}
	
	.float-icon {
		font-size: 36rpx;
		margin-right: 10rpx;
	}
	
	.float-text {
		color: #fff;
		font-size: 28rpx;
		font-weight: 500;
	}
}

.float-button-hover {
	transform: scale(1.05) translateY(-5rpx);
	box-shadow: 0 10rpx 25rpx rgba(26, 115, 232, 0.4);
}
</style>
```

## ä¸»è¦ä¿®æ”¹çš„å†…å®¹ï¼š

1. æ·»åŠ äº† `allProps` ref å˜é‡ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰é“å…·æ•°æ®
2. é‡å†™äº† `filteredProps` è®¡ç®—å±æ€§ï¼Œå®ç°æœ¬åœ°è¿‡æ»¤é€»è¾‘
3. ä¿®æ”¹äº† `fetchAllProps` æ–¹æ³•ï¼Œä¸€æ¬¡æ€§è·å–æ‰€æœ‰é“å…·
4. ä¿®æ”¹äº† `setFilter` æ–¹æ³•ï¼Œä»…æ”¹å˜ç­›é€‰æ¡ä»¶ï¼Œä¸é‡æ–°è¯·æ±‚æ•°æ®
5. æ·»åŠ äº† `handleLocalSearch` æ–¹æ³•ï¼Œå¤„ç†æœ¬åœ°æœç´¢
6. ç®€åŒ–äº† `loadMore` æ–¹æ³•ï¼Œåœ¨æœ¬åœ°è¿‡æ»¤æ¨¡å¼ä¸‹ä¸éœ€è¦åˆ†é¡µåŠ è½½

è¿™äº›ä¿®æ”¹ä½¿å¾—é“å…·åˆ—è¡¨å¯ä»¥åœ¨å‰ç«¯è¿›è¡Œæœ¬åœ°è¿‡æ»¤ï¼Œè€Œä¸å¿…æ¯æ¬¡ç­›é€‰éƒ½å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚å½“ç”¨æˆ·ç‚¹å‡»"å¯ç§Ÿå€Ÿ"æˆ–"ä¸å¯ç§Ÿå€Ÿ"é€‰é¡¹å¡æ—¶ï¼Œç³»ç»Ÿå°†ç›´æ¥æ ¹æ®é“å…·çš„ `available` å±æ€§è¿›è¡Œè¿‡æ»¤æ˜¾ç¤ºã€‚

---

_**User**_

prop.vue;,ä¸ç”¨å°é¢å›¾ï¼Œå°±æ˜¯ä¸Šé¢æ˜¾ç¤ºè½®æ’­å›¾ä¸€è¡Œï¼›ç„¶åä¸‹é¢æ˜¯åŸºæœ¬ä¿¡æ¯ï¼Œå†ä¸‹é¢æ˜¯æ˜¯ç«–å‘æ’åˆ—çš„å›¾ç‰‡ï¼Œå æ»¡ä¸€è¡Œï¼›åœ¨ç¼–è¾‘éƒ¨åˆ†çš„é€»è¾‘ä¹Ÿæ˜¯ï¼Œä¹Ÿè¦getpropdetail

---

_**Assistant**_

<think>
è®©æˆ‘ç†è§£ä¸€ä¸‹è¿™ä¸ªéœ€æ±‚ï¼š

1. åœ¨ prop.vue é¡µé¢ä¸­ï¼Œéœ€è¦è°ƒæ•´ prop çš„å±•ç¤ºæ–¹å¼
2. éœ€è¦ç§»é™¤å°é¢å›¾
3. ä¸Šé¢éœ€è¦æ˜¾ç¤ºè½®æ’­å›¾ï¼Œå ä¸€è¡Œ
4. ä¸‹é¢æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
5. å†ä¸‹é¢æ˜¯ç«–å‘æ’åˆ—çš„å›¾ç‰‡ï¼Œå æ»¡ä¸€è¡Œ
6. ç¼–è¾‘éƒ¨åˆ†çš„é€»è¾‘ä¹Ÿè¦ä¿®æ”¹ï¼Œéœ€è¦è°ƒç”¨ getpropdetail API

è¿™å¬èµ·æ¥åƒæ˜¯æƒ³è®© prop.vue é¡µé¢çš„å±•ç¤ºæ–¹å¼æ›´æ¥è¿‘ prop_detail.vue é¡µé¢çš„å±•ç¤ºæ–¹å¼ã€‚

é¦–å…ˆï¼Œæˆ‘éœ€è¦ä¿®æ”¹ prop.vue çš„æ¨¡æ¿éƒ¨åˆ†ï¼Œæ·»åŠ è½®æ’­å›¾å’Œè¯¦ç»†çš„ç«–å‘æ’åˆ—å›¾ç‰‡ã€‚ç„¶åéœ€è¦ä¿®æ”¹ JS éƒ¨åˆ†ï¼Œå¢åŠ å¯¹ getpropdetail çš„è°ƒç”¨ã€‚

ä»æä¾›çš„ä¸Šä¸‹æ–‡ä»£ç ä¸­ï¼Œæˆ‘å¯ä»¥çœ‹åˆ° prop.vue å’Œ prop_detail.vue çš„ç»“æ„ï¼Œä»¥åŠ getpropdetail API çš„ä½¿ç”¨æ–¹å¼ã€‚

æˆ‘å°†å¯¹ prop.vue è¿›è¡Œä¿®æ”¹ï¼Œä½¿å…¶å¸ƒå±€ç±»ä¼¼äº prop_detail.vueï¼Œä½†ä¿ç•™åŸæœ‰çš„ç­›é€‰å’Œæœç´¢åŠŸèƒ½ã€‚
</think>

# ä¿®æ”¹ prop.vue å®ç°æ–°å¸ƒå±€å’Œæœ¬åœ°è¿‡æ»¤

æ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œæˆ‘å°† prop.vue é¡µé¢è°ƒæ•´ä¸ºè½®æ’­å›¾+åŸºæœ¬ä¿¡æ¯+ç«–å‘å›¾ç‰‡çš„å¸ƒå±€ï¼Œå¹¶å®ç°æœ¬åœ°è¿‡æ»¤åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ä»£ç ï¼š

```vue
<template>
	<view class="prop-container">
		<view class="header">
			<view class="search-box">
				<text class="search-icon">ğŸ”</text>
				<input type="text" v-model="searchText" placeholder="æœç´¢å¿ƒç†é“å…·" class="search-input" @input="handleLocalFilter" />
			</view>
			<view class="filter-box">
				<view class="filter-item" 
					  v-for="(filter, index) in filters" 
					  :key="index"
					  :class="{ active: activeFilter === index }"
					  @tap="setFilter(index)">
					{{ filter }}
				</view>
			</view>
		</view>
		
		<scroll-view class="prop-list" scroll-y="true" @scrolltolower="loadMore">
			<view v-if="propList.length === 0 && !loading" class="empty-state">
				<image src="/static/images/empty.png" mode="aspectFit" class="empty-image"></image>
				<text class="empty-text">æš‚æ— é“å…·</text>
			</view>
			
			<view v-for="(item, index) in filteredProps" :key="index" class="prop-card" @tap="onPropClick(item.id)">
				<!-- è½®æ’­å›¾ -->
				<swiper class="prop-swiper" circular indicator-dots autoplay interval="3000" duration="500">
					<swiper-item v-if="item.coverImage">
						<image :src="item.coverImage" mode="aspectFill" class="swiper-image"></image>
					</swiper-item>
					<swiper-item v-for="(img, imgIndex) in (item.imageList || [])" :key="imgIndex">
						<image :src="img.imageUrl" mode="aspectFill" class="swiper-image"></image>
					</swiper-item>
				</swiper>
				
				<!-- åŸºæœ¬ä¿¡æ¯ -->
				<view class="prop-info">
					<view class="prop-header">
						<text class="prop-name">{{ item.name }}</text>
						<view class="prop-status" :class="item.available ? 'available' : 'unavailable'">
							{{ item.available ? 'å¯ç§Ÿå€Ÿ' : 'ä¸å¯ç§Ÿå€Ÿ' }}
						</view>
					</view>
					
					<view class="prop-desc">{{ item.description }}</view>
					
					<view class="prop-price-row">
						<text class="prop-price">Â¥{{ item.price }}/å¤©</text>
						<button 
							class="rent-btn" 
							:class="item.available ? 'active' : 'disabled'" 
							@tap.stop="rentProp(item)"
							:disabled="!item.available"
						>
							{{ item.available ? 'ç«‹å³ç§Ÿå€Ÿ' : 'ä¸å¯ç§Ÿå€Ÿ' }}
						</button>
					</view>
				</view>
				
				<!-- è¯¦ç»†å›¾ç‰‡ -->
				<view v-if="item.detailImageList && item.detailImageList.length > 0" class="prop-detail-images">
					<image 
						v-for="(detailImg, detailIndex) in item.detailImageList" 
						:key="detailIndex" 
						:src="detailImg.imageUrl" 
						mode="widthFix" 
						class="detail-image"
					></image>
				</view>
			</view>
			
			<view v-if="loading" class="loading">åŠ è½½ä¸­...</view>
			<view v-if="noMoreData" class="no-more">æ²¡æœ‰æ›´å¤šé“å…·äº†</view>
		</scroll-view>
		
		<!-- æ‚¬æµ®æŒ‰é’® -->
		<view class="float-button" hover-class="float-button-hover" @tap="navigateToMyRentals">
			<view class="float-button-inner">
				<text class="float-icon">ğŸ“¦</text>
				<text class="float-text">æˆ‘çš„ç§Ÿå€Ÿ</text>
			</view>
		</view>
	</view>
</template>

<script setup>
import { ref, computed, onMounted, watch } from 'vue';
import { getPropList, searchProp, getAvailableProps, getPropDetail } from '../../api/prop.js';

// ä¿ç•™åŸºæœ¬ ref å˜é‡
const searchText = ref('');
const filters = ref(['å…¨éƒ¨', 'å¯ç§Ÿå€Ÿ', 'ä¸å¯ç§Ÿå€Ÿ']);
const activeFilter = ref(0);
const loading = ref(false);
const noMoreData = ref(false);
const propList = ref([]);
const allProps = ref([]); // å­˜å‚¨æ‰€æœ‰é“å…·çš„å®Œæ•´æ•°æ®

// æœ¬åœ°è¿‡æ»¤
const filteredProps = computed(() => {
	let filtered = propList.value;
	
	// æ ¹æ®æœç´¢æ–‡æœ¬è¿‡æ»¤
	if (searchText.value.trim() !== '') {
		filtered = filtered.filter(prop => 
			(prop.name && prop.name.toLowerCase().includes(searchText.value.toLowerCase())) || 
			(prop.description && prop.description.toLowerCase().includes(searchText.value.toLowerCase()))
		);
	}
	
	// æ ¹æ®å¯ç”¨çŠ¶æ€è¿‡æ»¤
	if (activeFilter.value === 1) {
		filtered = filtered.filter(prop => prop.available === true);
	} else if (activeFilter.value === 2) {
		filtered = filtered.filter(prop => prop.available === false);
	}
	
	return filtered;
});

// ç›‘å¬æœç´¢æ–‡æœ¬å˜åŒ–
watch(searchText, (newVal) => {
	if (newVal.trim() === '') {
		// å¦‚æœæœç´¢æ–‡æœ¬ä¸ºç©ºï¼Œé‡æ–°æ˜¾ç¤ºæ‰€æœ‰é“å…·
		resetSearch();
	}
});

// é‡ç½®æœç´¢
const resetSearch = () => {
	// ä¸éœ€è¦é‡æ–°è¯·æ±‚æ•°æ®ï¼Œåªéœ€é‡ç½®è¿‡æ»¤
	searchText.value = '';
	handleLocalFilter();
};

// æœ¬åœ°è¿‡æ»¤å¤„ç†
const handleLocalFilter = () => {
	// ä¸éœ€è¦é¢å¤–æ“ä½œï¼Œä¾èµ–è®¡ç®—å±æ€§ filteredProps
};

// åŠ è½½æ‰€æœ‰é“å…·åˆ—è¡¨å¹¶è·å–è¯¦æƒ…
const fetchAllProps = async () => {
	if (loading.value) return;
	
	loading.value = true;
	propList.value = []; // æ¸…ç©ºç°æœ‰æ•°æ®
	
	try {
		// è·å–æ‰€æœ‰é“å…·åˆ—è¡¨
		const result = await getPropList();
		
		console.log('APIè¿”å›é“å…·æ•°æ®:', result);
		
		if (result.code === 1 && result.data && result.data.length > 0) {
			// è·å–åˆ°åŸºæœ¬é“å…·åˆ—è¡¨
			allProps.value = result.data;
			
			// ä¸´æ—¶å­˜å‚¨æ•°æ®
			propList.value = result.data;
			
			// é€ä¸ªè·å–é“å…·è¯¦æƒ…
			for (let i = 0; i < result.data.length; i++) {
				const propId = result.data[i].id;
				await fetchPropDetail(propId, i);
			}
		} else {
			propList.value = [];
		}
	} catch (error) {
		console.error('è·å–é“å…·åˆ—è¡¨å¤±è´¥:', error);
		uni.showToast({
			title: 'è·å–é“å…·åˆ—è¡¨å¤±è´¥',
			icon: 'none'
		});
	} finally {
		loading.value = false;
	}
};

// è·å–å•ä¸ªé“å…·è¯¦æƒ…
const fetchPropDetail = async (id, index) => {
	try {
		const result = await getPropDetail(id);
		
		if (result.code === 1 && result.data) {
			// æ›´æ–°é“å…·è¯¦æƒ…
			propList.value[index] = {
				...propList.value[index],
				...result.data,
				imageList: result.data.imageList || [],
				detailImageList: result.data.detailImageList || []
			};
		}
	} catch (error) {
		console.error(`è·å–é“å…·${id}è¯¦æƒ…å¤±è´¥:`, error);
	}
};

// è®¾ç½®ç­›é€‰æ¡ä»¶ - æœ¬åœ°è¿‡æ»¤
function setFilter(index) {
	if (activeFilter.value === index) return;
	
	activeFilter.value = index;
	// ä¸éœ€è¦é‡æ–°è¯·æ±‚æ•°æ®ï¼Œä»…ä¾èµ–è®¡ç®—å±æ€§è¿‡æ»¤
}

// ç‚¹å‡»é“å…·
function onPropClick(id) {
	console.log('ç‚¹å‡»é“å…·:', id);
	uni.navigateTo({
		url: `/pages/prop_detail/prop_detail?id=${id}`
	});
}

// ç§Ÿå€Ÿé“å…·
function rentProp(prop) {
	event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
	
	if (!prop.available) {
		uni.showToast({
			title: 'è¯¥é“å…·ä¸å¯ç§Ÿå€Ÿ',
			icon: 'none'
		});
		return;
	}
	
	uni.navigateTo({
		url: `/pages/prop_rental/prop_rental?id=${prop.id}`
	});
}

// å¯¼èˆªåˆ°æˆ‘çš„ç§Ÿå€Ÿ
function navigateToMyRentals() {
	uni.navigateTo({
		url: '/pages/order/order?activeTab=prop'
	});
}

// åŠ è½½æ›´å¤š - æœ¬åœ°ç‰ˆæœ¬ä¸éœ€è¦å®é™…åŠ è½½
function loadMore() {
	// ç”±äºä¸€æ¬¡æ€§åŠ è½½äº†æ‰€æœ‰æ•°æ®ï¼Œæ­¤å¤„ä¸éœ€è¦å®é™…è¯·æ±‚
}

// åˆå§‹åŠ è½½æ•°æ®
onMounted(() => {
	fetchAllProps();
});
</script>

<style lang="scss" scoped>
.prop-container {
	display: flex;
	flex-direction: column;
	height: 100vh;
	background-color: #f8f9fa;
	position: relative;
}

.header {
	padding: 30rpx 20rpx;
	background-color: #fff;
	box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);
	position: sticky;
	top: 0;
	z-index: 10;
	
	.search-box {
		display: flex;
		align-items: center;
		background-color: #f5f5f5;
		border-radius: 40rpx;
		padding: 15rpx 20rpx;
		margin-bottom: 20rpx;
		
		.search-icon {
			margin-right: 10rpx;
			font-size: 32rpx;
			color: #999;
		}
		
		.search-input {
			flex: 1;
			height: 60rpx;
			font-size: 28rpx;
		}
	}
	
	.filter-box {
		display: flex;
		justify-content: space-between;
		
		.filter-item {
			flex: 1;
			text-align: center;
			font-size: 26rpx;
			color: #666;
			padding: 10rpx 0;
			position: relative;
			
			&.active {
				color: #1a73e8;
				font-weight: 500;
				
				&::after {
					content: '';
					position: absolute;
					bottom: 0;
					left: 50%;
					transform: translateX(-50%);
					width: 40rpx;
					height: 4rpx;
					background-color: #1a73e8;
					border-radius: 2rpx;
				}
			}
		}
	}
}

.prop-list {
	flex: 1;
	padding: 20rpx;
	padding-bottom: 120rpx; /* ä¸ºæ‚¬æµ®æŒ‰é’®ç•™å‡ºç©ºé—´ */
}

.prop-card {
	background-color: #fff;
	border-radius: 16rpx;
	overflow: hidden;
	margin-bottom: 30rpx;
	box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.05);
}

.prop-swiper {
	width: 100%;
	height: 360rpx;
	
	.swiper-image {
		width: 100%;
		height: 100%;
	}
}

.prop-info {
	padding: 20rpx;
	
	.prop-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 16rpx;
		
		.prop-name {
			font-size: 32rpx;
			font-weight: bold;
			color: #333;
			flex: 1;
		}
		
		.prop-status {
			padding: 6rpx 16rpx;
			font-size: 24rpx;
			border-radius: 100rpx;
			

---



---

